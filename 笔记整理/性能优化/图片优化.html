<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>性能优化与图片 | Rio的个人博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/custom.js"></script>
    <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "https://hm.baidu.com/hm.js?16c5393dc56a6eb9bbcee539d51f932c";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
            </script>
    <meta name="description" content="欢迎光临我的小站">
    <meta name="keywords" content="vuepress,自建博客,张佳泽">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="author" content="Rio">
    
    <link rel="preload" href="/assets/css/0.styles.57064493.css" as="style"><link rel="preload" href="/assets/js/app.21d8bc19.js" as="script"><link rel="preload" href="/assets/js/4.413158b0.js" as="script"><link rel="preload" href="/assets/js/1.9e3ff7f5.js" as="script"><link rel="preload" href="/assets/js/75.9a122b7e.js" as="script"><link rel="preload" href="/assets/js/35.5e8c5ebb.js" as="script"><link rel="prefetch" href="/assets/js/10.4d7272d5.js"><link rel="prefetch" href="/assets/js/11.85a9f4ab.js"><link rel="prefetch" href="/assets/js/12.c6367947.js"><link rel="prefetch" href="/assets/js/13.b3ffbb60.js"><link rel="prefetch" href="/assets/js/14.2165e819.js"><link rel="prefetch" href="/assets/js/15.c4002921.js"><link rel="prefetch" href="/assets/js/16.d886965c.js"><link rel="prefetch" href="/assets/js/17.6af6b08d.js"><link rel="prefetch" href="/assets/js/18.389382d8.js"><link rel="prefetch" href="/assets/js/19.93027b39.js"><link rel="prefetch" href="/assets/js/20.56964997.js"><link rel="prefetch" href="/assets/js/21.9bbe6795.js"><link rel="prefetch" href="/assets/js/22.0fd6e694.js"><link rel="prefetch" href="/assets/js/23.ab696a08.js"><link rel="prefetch" href="/assets/js/24.0d8c8f20.js"><link rel="prefetch" href="/assets/js/25.230a2d2e.js"><link rel="prefetch" href="/assets/js/26.6a1ab86e.js"><link rel="prefetch" href="/assets/js/27.b3113a00.js"><link rel="prefetch" href="/assets/js/28.3d4b252f.js"><link rel="prefetch" href="/assets/js/29.56289ece.js"><link rel="prefetch" href="/assets/js/30.8fca3c5d.js"><link rel="prefetch" href="/assets/js/31.c28bc60f.js"><link rel="prefetch" href="/assets/js/32.2dcbd97b.js"><link rel="prefetch" href="/assets/js/33.4fcbc66e.js"><link rel="prefetch" href="/assets/js/34.27ee1437.js"><link rel="prefetch" href="/assets/js/36.23dcbe0e.js"><link rel="prefetch" href="/assets/js/37.d084d781.js"><link rel="prefetch" href="/assets/js/38.2f7dab6e.js"><link rel="prefetch" href="/assets/js/39.365bf6a5.js"><link rel="prefetch" href="/assets/js/40.b6fd96ab.js"><link rel="prefetch" href="/assets/js/41.fc561340.js"><link rel="prefetch" href="/assets/js/42.0d7790ac.js"><link rel="prefetch" href="/assets/js/43.2c5d2e13.js"><link rel="prefetch" href="/assets/js/44.f763d09b.js"><link rel="prefetch" href="/assets/js/45.8b0a5ee4.js"><link rel="prefetch" href="/assets/js/46.e7bd0958.js"><link rel="prefetch" href="/assets/js/47.2b716d10.js"><link rel="prefetch" href="/assets/js/48.de477525.js"><link rel="prefetch" href="/assets/js/49.ac4c6a6c.js"><link rel="prefetch" href="/assets/js/5.46b808e0.js"><link rel="prefetch" href="/assets/js/50.f9c6f676.js"><link rel="prefetch" href="/assets/js/51.8da92857.js"><link rel="prefetch" href="/assets/js/52.146cd716.js"><link rel="prefetch" href="/assets/js/53.51f2eb9b.js"><link rel="prefetch" href="/assets/js/54.66431ee4.js"><link rel="prefetch" href="/assets/js/55.2f28d369.js"><link rel="prefetch" href="/assets/js/56.815bf28e.js"><link rel="prefetch" href="/assets/js/57.37b7ad6e.js"><link rel="prefetch" href="/assets/js/58.b11a43a7.js"><link rel="prefetch" href="/assets/js/59.1b287051.js"><link rel="prefetch" href="/assets/js/6.a354029a.js"><link rel="prefetch" href="/assets/js/60.2840def1.js"><link rel="prefetch" href="/assets/js/61.8a483bbd.js"><link rel="prefetch" href="/assets/js/62.9387f55e.js"><link rel="prefetch" href="/assets/js/63.c1a2f032.js"><link rel="prefetch" href="/assets/js/64.b8f874ab.js"><link rel="prefetch" href="/assets/js/65.c86e62f6.js"><link rel="prefetch" href="/assets/js/66.3543c908.js"><link rel="prefetch" href="/assets/js/67.428bc02e.js"><link rel="prefetch" href="/assets/js/68.557cfcf7.js"><link rel="prefetch" href="/assets/js/69.1e23afeb.js"><link rel="prefetch" href="/assets/js/7.de47939a.js"><link rel="prefetch" href="/assets/js/70.b2c19a67.js"><link rel="prefetch" href="/assets/js/71.e6975e19.js"><link rel="prefetch" href="/assets/js/72.ae89999a.js"><link rel="prefetch" href="/assets/js/73.ac70f210.js"><link rel="prefetch" href="/assets/js/74.4cd625d4.js"><link rel="prefetch" href="/assets/js/76.46ca6219.js"><link rel="prefetch" href="/assets/js/77.29435812.js"><link rel="prefetch" href="/assets/js/78.c7074596.js"><link rel="prefetch" href="/assets/js/79.160babd2.js"><link rel="prefetch" href="/assets/js/8.db53d1c6.js"><link rel="prefetch" href="/assets/js/80.55fe71ab.js"><link rel="prefetch" href="/assets/js/81.d7d7a54f.js"><link rel="prefetch" href="/assets/js/82.2b757fe6.js"><link rel="prefetch" href="/assets/js/83.4be1d5d6.js"><link rel="prefetch" href="/assets/js/84.03c2b401.js"><link rel="prefetch" href="/assets/js/85.5584fd29.js"><link rel="prefetch" href="/assets/js/86.79d83e04.js"><link rel="prefetch" href="/assets/js/87.c41d9cd2.js"><link rel="prefetch" href="/assets/js/88.ac966169.js"><link rel="prefetch" href="/assets/js/89.ee65d026.js"><link rel="prefetch" href="/assets/js/9.bdffbb92.js"><link rel="prefetch" href="/assets/js/90.967fa859.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.de43bf3e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.57064493.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4698c43e><div data-v-4698c43e><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-4698c43e data-v-4698c43e><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-6cbeab0a data-v-4698c43e data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>Rio的个人博客</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Rio</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-4698c43e><header class="navbar" data-v-4698c43e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Rio的个人博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-note"></i>
      学习笔记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/笔记整理/javascript/js.html" class="nav-link"><i class="iconfont undefined"></i>
  Javascript
</a></li><li class="dropdown-subitem"><a href="/笔记整理/HTML5与CSS3/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  HTML5与CSS3
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/笔记整理/框架/Vue/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/TS专栏/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  Typescript专栏
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/工程化/工程化.html" class="nav-link"><i class="iconfont undefined"></i>
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/服务端渲染/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  服务端渲染
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/性能优化/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/算法与手撕JS/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  手写JS和算法
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/浏览器与计网/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  计网与浏览器
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/操作系统与组成原理/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  操作系统与计组
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/其他计算机知识/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  其他计算机相关知识
</a></li></ul></div></div><div class="nav-item"><a href="/知识大纲/" class="nav-link"><i class="iconfont reco-api"></i>
  知识大纲
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      友链
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://yihuiblog.top/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  Yihui's Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4698c43e></div> <aside class="sidebar" data-v-4698c43e><div class="personal-info-wrapper" data-v-6c8ffc9c><img src="/member1.jpg" alt="author-avatar" class="personal-img" data-v-6c8ffc9c> <h3 class="name" data-v-6c8ffc9c>
    Rio
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>57</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>15</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-note"></i>
      学习笔记
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/笔记整理/javascript/js.html" class="nav-link"><i class="iconfont undefined"></i>
  Javascript
</a></li><li class="dropdown-subitem"><a href="/笔记整理/HTML5与CSS3/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  HTML5与CSS3
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/笔记整理/框架/Vue/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/TS专栏/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  Typescript专栏
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/工程化/工程化.html" class="nav-link"><i class="iconfont undefined"></i>
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/服务端渲染/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  服务端渲染
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/性能优化/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/算法与手撕JS/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  手写JS和算法
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/浏览器与计网/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  计网与浏览器
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/操作系统与组成原理/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  操作系统与计组
</a></li><li class="dropdown-item"><!----> <a href="/笔记整理/其他计算机知识/overview.html" class="nav-link"><i class="iconfont undefined"></i>
  其他计算机相关知识
</a></li></ul></div></div><div class="nav-item"><a href="/知识大纲/" class="nav-link"><i class="iconfont reco-api"></i>
  知识大纲
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      友链
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://yihuiblog.top/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  Yihui's Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/笔记整理/性能优化/overview.html" class="sidebar-link">性能优化知识大纲</a></li><li><a href="/笔记整理/性能优化/图片优化.html" class="active sidebar-link">性能优化与图片</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#设备独立像素dip与device-pixel-ratio" class="sidebar-link">设备独立像素DIP与device-pixel-ratio</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#jpeg" class="sidebar-link">JPEG</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#png" class="sidebar-link">PNG</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#svg" class="sidebar-link">SVG</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#使用-iconfont" class="sidebar-link">使用 iconfont</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#使用-cdn-图片" class="sidebar-link">使用 CDN 图片</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#图片懒加载" class="sidebar-link">图片懒加载</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#图片预加载" class="sidebar-link">图片预加载</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#响应式图片" class="sidebar-link">响应式图片</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#图片逐渐加载" class="sidebar-link">图片逐渐加载</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#图片替代" class="sidebar-link">图片替代</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#服务器端优化图片" class="sidebar-link">服务器端优化图片</a></li><li class="sidebar-sub-header"><a href="/笔记整理/性能优化/图片优化.html#参考" class="sidebar-link">参考</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-6cbeab0a data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>性能优化与图片</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>Rio</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2023
        </a></span></div></div> <div data-v-4698c43e><main class="page"><!----> <div class="page-title" style="display:none;"><h1>性能优化与图片</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>Rio</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2023-08-10</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      性能优化
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p class="custom-block-title">总览</p> <p>图片格式、图片压缩、常见的图片性能优化手段等</p></div> <h2 id="设备独立像素dip与device-pixel-ratio"><a href="#设备独立像素dip与device-pixel-ratio" class="header-anchor">#</a> 设备独立像素DIP与device-pixel-ratio</h2> <p><strong>设备独立像素(DIP)</strong></p> <p>独立于设备的用于逻辑上衡量长度的单位，由底层系统的程序使用，会由相关系统转换为物理像素。所以它只是一个虚拟像素单位</p> <p><strong>物理像素和设备独立像素( device-independent pixels (dips) )的比例</strong></p> <p>即 devicePixelRatio = 屏幕物理像素/设备独立像素</p> <p>举个例子，iPhone 3GS 和 iPhone 4/4s 的尺寸都是 3.5 寸，但 iPhone 3GS 的分辨率是 320x480，iPhone 4/4s 的分辨率是 640x960，这也就是意味着同样长度的屏幕，iPhone 3GS 有 320 个物理像素，iPhone 4/4s 有 640 个物理像素。</p> <p>我们统一 iPhone 3GS 和 iPhone 4/4s 都是 320 个虚拟像素，只是在 iPhone 3GS 上，最终 1 个虚拟像素换算成 1 个物理像素，在 [iphone 4s](https://www.zhihu.com/search?q=iphone 4s&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra={&quot;sourceType&quot;%3A&quot;answer&quot;%2C&quot;sourceId&quot;%3A541637971}) 中，1 个虚拟像素最终换算成 2 个物理像素。</p> <p>至于 1 个虚拟像素被换算成几个物理像素，这个数值我们称之为设备像素比。</p> <p>我们主要通过：通过判断 devicePixelRatio 的值来加载不同尺寸的图片</p> <p>针对普通显示屏(devicePixelRatio = 1.0、1.3)，加载一张 1 倍的图片</p> <p>针对高清显示屏(devicePixelRatio &gt;= 1.5、2.0、3.0)，加载一张 2 倍大的图片</p> <h2 id="jpeg"><a href="#jpeg" class="header-anchor">#</a> JPEG</h2> <p>JPEG（Joint Photographic Experts Group）联合图像专家组 。是 JPEG 标准的产物，该标准由国际标准化组织（ISO）制订，是面向连续色调静止图像的一种压缩标准。 JPEG 格式是最常用的图像文件格式后缀名为 .jpg 或 .jpeg 。是一种针对彩色照片的有损压缩图形格式，压缩率高。</p> <p>优势</p> <ul><li>它支持极高的压缩率，因此JPEG图像的下载速度大大加快。</li> <li>它能够轻松地处理16.8M颜色，可以很好地再现全彩色的图像。</li> <li>在对图像的压缩处理过程中，该图像格式可以允许自由地在最小文件尺寸（最低图像质量）和最大文件尺寸（最高图像质量）之间选择。</li> <li>该格式的文件尺寸相对较小，下载速度快，有利于在带宽并不“富裕”的情况下传输。</li></ul> <p>劣势</p> <ul><li>并非所有的浏览器都支持将各种JPEG图像插入网页。</li> <li>压缩时，可能使图像的质量受到损失，因此不适宜用该格式来显示高清晰度的图像。</li></ul> <p>适合使用的场景:颜色丰富的照片</p> <p>不适合使用的场景:线条图形和文字、图标图形，因为它的压缩算法不太适合这些类型的图形;并且不支持透明度。</p> <h2 id="png"><a href="#png" class="header-anchor">#</a> PNG</h2> <p>png (Portable Network Graphics) 便携式网络图形，是一种采用无损压缩算法的位图格式，其设计目的是试图替代<a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2FGIF" target="_blank" rel="noopener noreferrer">GIF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2FTIFF%2F2106" target="_blank" rel="noopener noreferrer">TIFF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文件格式，同时增加一些<a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2FGIF%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F" target="_blank" rel="noopener noreferrer">GIF文件格式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>所不具备的特性。</p> <p>PNG格式有8位、24位、32位三种形式，其中8位PNG支持两种不同的透明形式（索引透明和alpha透明），24位PNG不支持透明，32位PNG在24位基础上增加了8位透明通道，因此可展现256级透明程度。</p> <p>PNG8和PNG24后面的数字则是代表这种PNG格式最多可以索引和存储的颜色值。8代表2的8次方也就是256色，而24则代表2的24次方大概有1600多万色。</p> <p>优势</p> <ul><li>无损压缩</li> <li>完全支持 alpha 透明度。</li> <li>可以重复保存且不降低图像质量</li></ul> <p>劣势</p> <ul><li>体积偏大</li></ul> <p>适合的场景：纯色、透明、线条绘图、图标、边缘清晰，有大块相同颜色区域。颜色数较少，但是需要半透明。</p> <p>不适合的场景：由于无损存储，图片体积较大，不适合需要图片特别大和彩色图像的场景。</p> <h2 id="svg"><a href="#svg" class="header-anchor">#</a> SVG</h2> <p>SVG Scalable Vector Graphics，意思为可缩放的<a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%BD%A2%2F1450649" target="_blank" rel="noopener noreferrer">矢量图形<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。严格来说应该是一种开放标准的矢量图形语言，可让你设计高分辨率的Web图形页面。用户可以直接用代码来描绘图像，可以用任何文字处理工具打开SVG图像，通过改变部分代码来使图像具有交互功能，并可以随时插入到HTML中通过浏览器来观看。</p> <p>优势</p> <ul><li>SVG 可被非常多的工具读取和修改</li> <li>SVG 与 JPEG 和 GIF 图像比起来，尺寸更小，且可压缩性更强</li> <li>SVG 可在图像质量不下降的情况下被放大</li></ul> <p>劣势</p> <ul><li>不是所有的浏览器都支持SVG，IE8和早期版本都需要一个插件</li> <li>复杂的图片会降低渲染速度(只支持小图)</li></ul> <p>IE8和早期版本的 ie 浏览器，如果想在页面中展现 svg 图片，需要安装 adobe 的 SVGView 插件。</p> <p>适合：高分辨率打印图片程序、设计动画、演示等...</p> <p>不适合：对渲染速度要求比较大的网站，不适合需要图片特别大的场景。</p> <h2 id="使用-iconfont"><a href="#使用-iconfont" class="header-anchor">#</a> 使用 iconfont</h2> <p>iconfont(字体图标)，即通过字体的方式展示图标，多用于渲染图标、简单图形、特殊字体等。</p> <ul><li>像使用字体一样，设置大小、颜色及其他样式，不失真</li> <li>轻量，易修改</li> <li>有效减少 HTTP 请求次数</li></ul> <h2 id="使用-cdn-图片"><a href="#使用-cdn-图片" class="header-anchor">#</a> 使用 CDN 图片</h2> <p>CDN 的全称是 Content Delivery Network，即内容分发网络。CDN 是构建在网络之上的内容分发网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。CDN 的关键技术主要有内容存储和分发技术。</p> <p><strong>基本原理</strong></p> <p>CDN 的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。</p> <p><strong>基本思路</strong></p> <p>CND 的基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN 系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。其目的是使用户可就近取得所需内容，解决 Internet 网络拥挤的状况，提高用户访问网站的响应速度。</p> <p><strong>CDN 的优势</strong></p> <ul><li>CDN 节点解决了跨运营商和跨地域访问的问题，访问延时大大降低；</li> <li>大部分请求在 CDN 边缘节点完成，CDN 起到了分流作用，减轻了源站的负载。</li></ul> <h2 id="图片懒加载"><a href="#图片懒加载" class="header-anchor">#</a> 图片懒加载</h2> <p>懒加载是一种网页性能优化的方式，它能极大的提升用户体验。图片一直是影响网页性能的主要元凶，现在一张图片超过几兆已经是很经常的事了。如果每次进入页面就请求所有的图片资源，那么可能等图片加载出来用户也早就走了。所以进入页面的时候，只请求可视区域的图片资源。</p> <p>总结出来就是：</p> <ul><li>减少资源的加载，页面启动只加载首屏的图片，这样能明显减少了服务器的压力和流量，也能够减小浏览器的负担。</li> <li>防止并发加载的资源过多而阻塞 js 的加载，影响整个网站的启动，影响用户体验</li> <li>浪费用户的流量，有些用户并不想全部看完，全部加载会耗费大量流量。</li></ul> <p><strong>原理</strong></p> <p>图片懒加载的原理就是暂时不设置图片的 src 属性，而是将图片的 url 隐藏起来，比如先写在 data-src 里面，等当前图片是否到了可视区域再将图片真实的 url 放进 src 属性里面，从而实现图片的延迟加载。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> viewHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight <span class="token comment">//获取可视区高度</span>
  <span class="token keyword">let</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'img[data-src]'</span><span class="token punctuation">)</span>
  imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token comment">// 用于获得页面中某个元素的左，上，右和下分别相对浏览器视窗的位置</span>
    <span class="token keyword">let</span> rect <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>bottom <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rect<span class="token punctuation">.</span>top <span class="token operator">&lt;</span> viewHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span>src <span class="token operator">=</span> item<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src
      item<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 可以使用节流优化一下</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> lazyload<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>通过上面例子的实现，我们要实现懒加载都需要去监听 scroll 事件，尽管我们可以通过函数节流的方式来阻止高频率的执行函数,但是我们还是需要去计算 scrollTop,offsetHeight 等属性，有没有简单的不需要计算这些属性的方式呢，答案是有的---IntersectionObserver</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'img[data-src]'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">rootMargin</span><span class="token operator">:</span> <span class="token string">'0px'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries<span class="token punctuation">,</span> self</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  entries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> img <span class="token operator">=</span> entry<span class="token punctuation">.</span>target
      <span class="token keyword">let</span> src <span class="token operator">=</span> img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src
      <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
        img<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 解除观察</span>
      self<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span>

imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">image</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="图片预加载"><a href="#图片预加载" class="header-anchor">#</a> 图片预加载</h2> <p>图片预加载，是指在一些需要展示大量图片的网站，将图片提前加载到本地缓存中，从而提升用户体验。</p> <p>常用的方式有两种，一种是隐藏在 css 的 background 的 url 属性里面，一种是通过 javascript 的 Image 对象设置实例对象的 src 属性实现图片的预加载。</p> <p><strong>1、用 CSS 和 JavaScript 实现预加载</strong></p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#preload-01</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>http://domain.tld/image-01.png<span class="token punctuation">)</span></span> no-repeat -9999px -9999px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#preload-02</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>http://domain.tld/image-02.png<span class="token punctuation">)</span></span> no-repeat -9999px -9999px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#preload-03</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>http://domain.tld/image-03.png<span class="token punctuation">)</span></span> no-repeat -9999px -9999px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>通过 CSS 的 background 属性将图片预加载到屏幕外的背景上。当它们在 web 页面的其他地方被调用时，浏览器就会在渲染过程中使用预加载（缓存）的图片。该方法虽然高效，但仍有改进余地。使用该法加载的图片会同页面的其他内容一起加载，增加了页面的整体加载时间。
为了解决这个问题，我们增加了一些 JavaScript 代码，来推迟预加载的时间，直到页面加载完毕。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">preloader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>getElementById<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'preload-01'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span>
      <span class="token string">'url(http://domain.tld/image-01.png) no-repeat -9999px -9999px'</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'preload-02'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span>
      <span class="token string">'url(http://domain.tld/image-02.png) no-repeat -9999px -9999px'</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'preload-03'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span>
      <span class="token string">'url(http://domain.tld/image-03.png) no-repeat -9999px -9999px'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">addLoadEvent</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> oldonload <span class="token operator">=</span> window<span class="token punctuation">.</span>onload
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window<span class="token punctuation">.</span>onload <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>onload <span class="token operator">=</span> func
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>oldonload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">oldonload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">addLoadEvent</span><span class="token punctuation">(</span>preloader<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>2、使用 JavaScript 实现预加载</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">preloader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>images<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> img1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> img2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> img3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    img1<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://domain.tld/path/to/image-001.gif'</span>
    img2<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://domain.tld/path/to/image-002.gif'</span>
    img3<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://domain.tld/path/to/image-003.gif'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">addLoadEvent</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> oldonload <span class="token operator">=</span> window<span class="token punctuation">.</span>onload
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window<span class="token punctuation">.</span>onload <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>onload <span class="token operator">=</span> func
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>oldonload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">oldonload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">addLoadEvent</span><span class="token punctuation">(</span>preloader<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="响应式图片"><a href="#响应式图片" class="header-anchor">#</a> 响应式图片</h2> <p>根据用户的设备和使用场景提供合适的图片，在不同的网络环境下，加载不同尺寸和像素的图片。一般都是通过图片 URL 的参数来改变图片的尺寸。</p> <p>根据用户的设备和使用场景提供合适的图片。对于开发者来说不可能预见用户使用的浏览器的所有设置，只有浏览器在打开和渲染的时候才会知道它设备的具体情况（屏幕大小、能力、尺寸等）。针对这些请求，开发者一般会准备不同版本的图片，例如：大、中、小，不同版本的图片对于不同屏幕大小和分辨率。选择最适合的视图尺寸往往能减少图片的大小，让图片加载的更快。</p> <p>srcset 切换分辨率</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>img 
  src<span class="token operator">=</span><span class="token string">&quot;纸箱回收.png&quot;</span> 
  srcset<span class="token operator">=</span><span class="token string">&quot;金属类.png 1.1x, 布料类.png 1.2x&quot;</span>
<span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLK-Champ%2Fbase-js%2Fblob%2Ffe-crose-page%2Fimage-op%2Fsrc%2Fsrcset" target="_blank" rel="noopener noreferrer">测试源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92c296c3fa9b48e2b2fd4a8ec6250a9d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>注意: 在 Chrome 中测试时，通过如下方式禁用缓存：打开 DevTools ，并选中 Settings &gt; Preferences &gt; Network下Disable cache的选择框。否则，Chrome 会优先选择缓存图片而不是恰好适配的那个。</p> <p>src 属性是我们非常熟悉的一个属性，在这里有两个作用：</p> <ul><li>指定 1x 大小的图片</li> <li>在浏览器不支持 srcset 属性时的后备方案</li></ul> <p>srcset 属性（浏览器支持的情况下），通过逗号分割图片的描述，让浏览器自己决定使用哪一个图片。</p> <p><strong>但是不幸的是，这种写法会带来一些问题，例如 375像素 1x 、900像素 1.25x 都是使用的相同的图片，这其实并不是我们想要的结果。</strong></p> <p>srcset &amp; sizes 联合切换</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>srcset<span class="token operator">=</span>&quot;uswnt<span class="token operator">-</span><span class="token number">480</span><span class="token punctuation">.</span>png 480w<span class="token punctuation">,</span> 
    uswnt<span class="token operator">-</span><span class="token number">640</span><span class="token punctuation">.</span>png 640w<span class="token punctuation">,</span> 
    uswnt<span class="token operator">-</span><span class="token number">960</span><span class="token punctuation">.</span>png 960w<span class="token punctuation">,</span>
    uswnt<span class="token operator">-</span><span class="token number">1280</span><span class="token punctuation">.</span>png 1280w&quot; 
  sizes<span class="token operator">=</span>&quot;<span class="token punctuation">(</span>max<span class="token operator">-</span>width<span class="token operator">:</span> 480px<span class="token punctuation">)</span> 50vw<span class="token punctuation">,</span> 
  <span class="token punctuation">(</span>max<span class="token operator">-</span>width<span class="token operator">:</span> 640px<span class="token punctuation">)</span> 25vw<span class="token punctuation">,</span> 
    <span class="token punctuation">(</span>max<span class="token operator">-</span>width<span class="token operator">:</span> 960px<span class="token punctuation">)</span> 50vw<span class="token punctuation">,</span> 
    <span class="token punctuation">(</span>max<span class="token operator">-</span>width<span class="token operator">:</span> 1280px<span class="token punctuation">)</span> 50vw<span class="token punctuation">,</span> 
    640px&quot; 
  src<span class="token operator">=</span><span class="token string">&quot;uswnt-640.png&quot;</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLK-Champ%2Fbase-js%2Fblob%2Ffe-crose-page%2Fimage-op%2Fsrc%2Fsrcset%26sizes" target="_blank" rel="noopener noreferrer">测试源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>利用srcset和sizes信息来选择最符合规定条件的图像。</p> <p>我测试电脑的 dpr = 2；</p> <ul><li>如果浏览器的 viewport 为小于等于 480 像素，图片宽高为 50%（宽高 = 480 * 0.5），浏览器视图加载一张 480 * 0.5 * dpr(2) = 480像素的图片，uswnt-480.png。</li></ul> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df845a6fd4cb490c8c4f6598784d3fbe~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <ul><li><p>如果浏览器的 viewport 为小于等于 640 像素，图片宽高为 25%（宽高 = 640 * 0.25），浏览器视图加载一张 640 * 0.25* dpr(2) = 320 像素的图片，浏览器会尝试加载一张靠近尺寸的图片 uswnt-480.png（如图一所示）。</p></li> <li><ul><li>如果我这里将 25 vw 修改为 40 vw，640 * 0.4* dpr(2) = 512，相对 640 和 480 更加接近 480 所以会显示 uswnt-480.png（如图二所示）。</li> <li>如果我这里将 25 vw 修改为 45 vw，640 * 0.45* dpr(2) = 576，相对 640 和 480 更加接近 640 所以会显示 uswnt-640.png（如图三所示）。</li></ul></li></ul> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/228801754b2c4634b3a418b221f7e377~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>图一</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be0b86a7b6074df2b60c27a7a31e07aa~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>图二</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6de200bdcc3e44adba25b6487781fb81~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>图三</p> <p>注意：sizes 属性仅仅是对浏览器给出提示，并不能保证浏览器就会言听计从。所以我们无法确定究竟显示哪张图像，因为每个浏览器根据我们提供的信息挑选适当图像的算法是有差异的。srcset 和 size 列表是对浏览器的一个建 议(hint)，而非指令。例如，设备像素比(dpr)为1.5的设备，亦可用1x也可用2x的图像，由浏览器根据其能力、网络等因素来决定</p> <p><strong>picture 元素</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/media/cc0-images/surfer-240-200.jpg<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(min-width: 800px)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/media/cc0-images/painted-hand-298-332.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>要决定加载哪个 URL，<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FGlossary%2FUser_agent" target="_blank" rel="noopener noreferrer">user agent<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 检查每个  的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FElement%2Fsource%23attr-srcset" target="_blank" rel="noopener noreferrer">srcset<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FElement%2Fsource%23attr-media" target="_blank" rel="noopener noreferrer">media<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FElement%2Fsource%23attr-type" target="_blank" rel="noopener noreferrer">type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 属性，来选择最匹配页面当前布局、显示设备特征等的兼容图像。</p> <p>media 属性</p> <p>media 属性允许你提供一个用于给用户代理作为选择  元素的依据的媒体条件 (media condition)（类似于媒体查询）。如果这个媒体条件匹配结果为 false，那么这个  元素会被跳过。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(min-width: 600px)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MDN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8c9ff1a1e6cf4c1f8320fbffe9d16f6a~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>type 属性</p> <p>type 属性允许你为  元素的 srcset 属性指向的资源指定一个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTTP%2FBasics_of_HTTP%2FMIME_types" target="_blank" rel="noopener noreferrer">MIME 类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。如果用户代理不支持指定的类型，那么这个  元素会被跳过。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/svg+xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MDN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf85d875918a465fa268490dac98c31a~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p><strong>不建议使用 CSS 或 JavaScript 来做响应式图片的效果</strong></p> <p>当浏览器开始加载一个页面, 它会在主解析器开始加载和解析页面的 CSS 和 JavaScript 之前先下载 (预加载) 任意的图片。这是一个非常有用的技巧，平均下来减少了页面加载时间的20%。但是, 这对响应式图片一点帮助都没有, 所以需要类似 srcset的实现方法。因为你不能先加载好元素后, 再用 JavaScript 检测可视窗口的宽度，如果觉得大小不合适，再动态地加载小的图片替换已经加载好的图片，这样的话, 原始的图像已经被加载了, 然后你又加载了小的图像, 这样的做法对于响应式图像的理念来说，是很糟糕的。</p> <h2 id="图片逐渐加载"><a href="#图片逐渐加载" class="header-anchor">#</a> 图片逐渐加载</h2> <p>统一占位符</p> <p>在图片还处于加载中时，通常需要填充页面预览效果，这时往往会用到图片占位符，例如：天猫、京东使用一个 div 来充当图片加载中的占位。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2dc57a0c36304ad5ae74ed3351bbde5c~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41a83b5c5ca347b7a516a4811c81f197~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ecbd809eaa144228fe9e3d9274d79ec~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae0230f1df8a4bd48312d8964a312235~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>我们也可以使用 js 的手段，动态的修改 img 的 src 达到占位的效果。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>xml复制代码 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span>
   div {
     height: 1024px;
     width: 1024px;
   }
   img {
     position: relative;
     height: 100%;
     width: 100%;
   }
    
   img::after {
     content: &quot;&quot;;
      height: 100%;
      width: 100%;
      position: absolute;
      background: url(1.png) no-repeat center;
    }
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
    setTimeout(function() {
        document.querySelectorAll(&quot;img&quot;)[0].src = '2.png';
    }, 3000);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>LQIP： Low Quality Image Placeholders</p> <p>根据原始图片自动生成超小尺寸的缩略图。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2b0921e7bb94f28b5026c87542552e8~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> lqip <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lqip'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./dest/to/file/zouhir-riding-a-bike.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

lqip<span class="token punctuation">.</span><span class="token function">base64</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhY.....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意：lqip 只支持 'jpeg', 'jpg', 'png'</p> <p>利用生成的 base64 来填充 src，但是我们在实际的项目中肯定不能手动的为每一张图片都用 lqip 生成一个 base64 填充到 img 中，这样效率也太慢了。所以工程化的角度有一个 lqip-loader 为JS 包中导入的 jpeg 图像生成 Base64。</p> <p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzouhir%2Flqip-loader%23readme" target="_blank" rel="noopener noreferrer">lqip-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>并且针对 Base64，在 Chrome 为了节省内存和提高 GPU 性能，浏览器（包括从 61.0.3163.38 开始的 Chrome）现在将呈现稍微更清晰或像素化的 Base64 编码图像。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e31161476b1341e0a6a19bb2b542cd95~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <p>左侧是旧版 Chrome，右侧是 Chrome v61</p> <p>SQIP：SVG-based LQIP technique</p> <p>SQIP 将生成基于 SVG 的图像预览。它们可以用作延迟加载图像预览、视频缩略图或项目的艺术元素。</p> <p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faxe312ger%2Fsqip" target="_blank" rel="noopener noreferrer">SQIP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9087d59c452442d69afa1441c66eda56~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="img"></p> <h2 id="图片替代"><a href="#图片替代" class="header-anchor">#</a> 图片替代</h2> <p>Data URI</p> <p>Data URI其实就是将图片数据转成base64字符串格式，再引入，相比普通的引入方式它不再需要发起网络请求，从而达到优化网页快速加载的目的（减少http请求）。</p> <p>Data URI适用的场景</p> <ul><li>图片体积较小，没必要浪费一次http请求</li> <li>访问外部资源受限或者很麻烦的情况</li> <li>外部图片为动态的</li></ul> <p>Data URI引入方式的一些缺点</p> <ul><li>Base64编码的数据体积是原始二进制图片的4/3，也就是大1/3</li> <li>虽然相比普通引入加载更快，但是渲染更加耗时。实验结果显示 Data URI 的渲染比普通图片多消耗 53% 左右的CPU资源，内存多出4倍左右，耗时平均高出24.6倍，所以要在可接受的范围内适量使用</li> <li>不会被浏览器缓存（可以通过css引入的方式来缓存）</li></ul> <h2 id="服务器端优化图片"><a href="#服务器端优化图片" class="header-anchor">#</a> 服务器端优化图片</h2> <p>图片服务器自动优化是可以在图片 URL 链接上增加不同参数，服务器自动生成不同格式、大小、质量的一种技术。例如在前面提到的「图片尺寸随网络环境变化」通过修改 URL 参数来达到目的也就是这样一个例子。</p> <h3 id="常见的服务端处理功能"><a href="#常见的服务端处理功能" class="header-anchor">#</a> 常见的服务端处理功能</h3> <ul><li>图片裁剪：按照长度、宽度、固定大小、长边、短边、填充、拉伸等缩放</li> <li>图片格式装换：支持不同图片格式 jpg、gif、png、webp，支持不同的图片压缩率</li> <li>图片处理：添加图片水印、模糊等</li> <li>AI 处理：图片鉴别、抠图、排版、配色、合成等</li></ul> <h3 id="服务端优化实现技术"><a href="#服务端优化实现技术" class="header-anchor">#</a> 服务端优化实现技术</h3> <ul><li>将图片压缩、裁剪、格式转换等本地攻击部署到线上图片服务器上</li> <li>内部运营或外网用户上传本地图片到图片服务知乎，服务器默认处理转换为多种格式，并推送到图片 CDN 服务器上</li> <li>图片服务器对外开放多个域名，同事对各个业务线开发不同的业务路径</li> <li>外网永华请求带特殊参数的图片 URL 时，图片服务器根据 URL 种不同的参数类型，从本地缓存中存取，或者实现对图片进行即时处理，返回给客服端</li></ul> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p><a href="https://juejin.cn/post/7103311752170831902#heading-33" target="_blank" rel="noopener noreferrer">图片优化不完全指北 - 掘金 (juejin.cn)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.zhihu.com/question/26653449/answer/541637971" target="_blank" rel="noopener noreferrer">什么叫物理像素值，什么叫设备独立像素值（dips）? - 知乎 (zhihu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6965761736083243044#comment" target="_blank" rel="noopener noreferrer">前端性能优化——图片篇 - 掘金 (juejin.cn)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">最近更新于: </span> <span class="time">8/10/2023, 2:01:02 AM</span></div></footer> <!----> <!----></main> <!----> <div class="comments-wrapper" data-v-4698c43e><!----></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://music.163.com/song/media/outer/url?id=316756.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://p2.music.126.net/qOOTIykbSLw9RHB0vI83GA==/737772302281958.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>大城小事</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>杨千嬅</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----></div></div>
    <script src="/assets/js/app.21d8bc19.js" defer></script><script src="/assets/js/4.413158b0.js" defer></script><script src="/assets/js/1.9e3ff7f5.js" defer></script><script src="/assets/js/75.9a122b7e.js" defer></script><script src="/assets/js/35.5e8c5ebb.js" defer></script>
  </body>
</html>
